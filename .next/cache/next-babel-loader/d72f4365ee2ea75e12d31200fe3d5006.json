{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport Link from 'next/link';\nimport { useState, useEffect } from 'react';\nimport Router from 'next/router';\nimport { getCookie, isAuth } from '../../actions/auth';\nimport { list, removeBlog, publish } from '../../actions/blog';\nimport moment from 'moment';\n\nconst BlogRead = ({\n  username\n}) => {\n  const {\n    0: blogs,\n    1: setBlogs\n  } = useState([]);\n  const {\n    0: message,\n    1: setMessage\n  } = useState('');\n  const token = getCookie('token');\n  useEffect(() => {\n    loadBlogs();\n  }, []);\n\n  const loadBlogs = () => {\n    list(username).then(data => {\n      //console.log(data)\n      if (data.error) {\n        console.log(data.error);\n      } else {\n        setBlogs(data);\n      }\n    });\n  };\n\n  const deleteBlog = slug => {\n    removeBlog(slug, token).then(data => {\n      if (data.error) {\n        console.log(data.error);\n      } else {\n        setMessage(data.message);\n        loadBlogs();\n      }\n    });\n  };\n\n  const deleteConfirm = slug => {\n    let answer = window.confirm('Are you sure you want to reject this blog?');\n\n    if (answer) {\n      deleteBlog(slug);\n    }\n  };\n\n  const publishBlog = id => {\n    publish(id, token).then(data => {\n      console.log(data);\n\n      if (data.error) {\n        console.log(data.error);\n      } else {\n        setMessage(data.message);\n        loadBlogs();\n      }\n    });\n  };\n\n  const publishConfirm = slug => {\n    let answer = window.confirm('Are you sure you want to publish this blog?');\n\n    if (answer) {\n      publishBlog(slug);\n    }\n  };\n\n  const showUpdateButton = blog => {\n    if (isAuth() && isAuth().role === 0) {\n      return __jsx(Link, {\n        href: `/user/crud/${blog.slug}`\n      }, __jsx(\"a\", {\n        className: \"ml-2 btn btn-sm btn-warning\"\n      }, \"Update\"));\n    } else if (isAuth() && isAuth().role === 1) {\n      return __jsx(Link, {\n        href: `/admin/crud/${blog.slug}`\n      }, __jsx(\"a\", {\n        className: \"ml-2 btn btn-sm btn-warning\"\n      }, \"View/Make Changes\"));\n    }\n  };\n\n  const showAllBlogs = () => {\n    return blogs.map((blog, i) => {\n      var check = \"\";\n\n      if (blog.isPublished == false) {\n        check = \"Blog will be published after the admin reviews and publishes it\";\n        return __jsx(\"div\", {\n          key: i,\n          className: \"pb-5\"\n        }, __jsx(\"h3\", null, blog.title), __jsx(\"p\", {\n          className: \"mark\"\n        }, \"Written by \", __jsx(\"a\", {\n          href: `/profile/${blog.postedBy.username}`\n        }, blog.postedBy.name), \" | \", check), __jsx(\"button\", {\n          className: \" btn btn-sm btn-success\",\n          onClick: () => publishConfirm(blog.slug)\n        }, \"Publish\"), __jsx(\"button\", {\n          className: \"ml-2 btn btn-sm btn-danger\",\n          onClick: () => deleteConfirm(blog.slug)\n        }, \"Reject\"), showUpdateButton(blog));\n      }\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-12\"\n  }, message && __jsx(\"div\", {\n    className: \"alert alert-primary\"\n  }, message), showAllBlogs())));\n};\n\nexport default BlogRead;","map":null,"metadata":{},"sourceType":"module"}